
//                               █         █    █            ▄▄▄▀▀▀▀▀▀▄▄▄        █▀▀▀▀▀▀▀▀▀▀█
//                               █        █     █          ▄▀            ▀▄      █          █
//                               █       █      █        ▄▀                ▀▄    █          █
//                               █      █       █        █                  █    █          █
//                               █     █        █       █                    █   █          █
//                               █    █         █       █                    █   █▄▄▄▄▄▄▄▄▄▄█
//                               █   █ █        █       █                    █   █      █
//                               █  █   █       █        █                  █    █       █
//                               █ █     █      █        ▀▄                ▄▀    █        █
//                               ██       █     █          ▀▄            ▄▀      █         █
//                               █         █    █▄▄▄▄▄▄▄▄    ▀▀▀▄▄▄▄▄▄▀▀▀        █          █
//
// ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
       
#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/bt.h>
#include <dt-bindings/zmk/outputs.h>
#include <dt-bindings/zmk/ext_power.h>
#include <dt-bindings/zmk/rgb.h>
#include "keycodes_cs.h"


#define BASE    0
#define NAV     1
#define NUM     2
#define SYM     3
#define FUN     4
#define CZECH   5
#define WINMGR  6



/ {
    behaviors {
        hml: home_row_mod_left {
            compatible = "zmk,behavior-hold-tap";
            #binding-cells = <2>;
            flavor = "balanced";
            require-prior-idle-ms = <150>;
            tapping-term-ms = <280>;
            quick-tap-ms = <175>;
            bindings = <&kp>, <&kp>;
            hold-trigger-key-positions = <
                5 6 7 8 9
                16 17 18 19 20 21
                31 32 33 34
                41 42 43
            >; // right halve
            hold-trigger-on-release;
        };
        hmr: home_row_mod_right {
            compatible = "zmk,behavior-hold-tap";
            #binding-cells = <2>;
            flavor = "balanced";
            require-prior-idle-ms = <150>;
            tapping-term-ms = <280>;
            quick-tap-ms = <175>;
            bindings = <&kp>, <&kp>;
            hold-trigger-key-positions = <
                0 1 2 3 4
                10 11 12 13 14 15
                23 24 25 26
                36 37 38
                >; // left halve
            hold-trigger-on-release;
        };
    };


    macros {
        cs_car: cs_car {
            label = "cs_caron";
            compatible = "zmk,behavior-macro-one-param";
            #binding-cells = <1>;
            wait-ms = <40>;
            tap-ms = <40>;
            bindings =
                <&kp CS_CARON &macro_param_1to1 &kp MACRO_PLACEHOLDER>
            ;
        };

        cs_acu: cs_acu {
            label = "cs_acute";
            compatible = "zmk,behavior-macro-one-param";
            #binding-cells = <1>;
            wait-ms = <40>;
            tap-ms = <40>;
            bindings =
                <&kp CS_ACUTE &macro_param_1to1 &kp MACRO_PLACEHOLDER>
            ;
        };

        cs_ring: cs_ring {
            label = "cs_ring";
            compatible = "zmk,behavior-macro-one-param";
            #binding-cells = <1>;
            wait-ms = <40>;
            tap-ms = <40>;
            bindings =
                <&kp CS_RING &macro_param_1to1 &kp MACRO_PLACEHOLDER>
            ;
        };
    };

    keymap {
        compatible = "zmk,keymap";

        // ##############################

        base_layer {
            display-name= "BASE";
            bindings = <
                     &kp CS_J   &kp CS_W   &kp CS_F   &kp CS_P   &kp CS_G
                     &kp CS_J   &kp CS_L   &kp CS_U   &kp CS_Y   &kp CS_B

             &kp CS_Z   &kp CS_A   &kp CS_R   &kp CS_S   &kp CS_T   &kp CS_D
             &kp CS_H   &kp CS_N   &kp CS_E   &kp CS_I   &kp CS_O   &kp CS_K 

             &none   &kp LALT   &hml LCTRL CS_COMMA    &hml LSHFT CS_LPAR    &hml LWIN CS_V    &none    &none
             &none   &none      &hmr RWIN CS_M         &hmr RSHFT CS_RPAR    &hmr LCTRL CS_DOT   &hmr LALT CS_QMARK    &none

                                                   &lt WINMGR ESC    &lt NAV SPC     &lt CZECH TAB   &none
                                                   &none             &lt FUN ENTER   &lt NUM BACKSPACE &lt SYM DELETE   
            >;
        };

        // ##############################

        nav_layer {
            display-name= "NAV";
            bindings = <
                     &none       &none      &none       &none       &none
                     &kp K_APP   &kp HOME   &kp PG_DN   &kp PG_UP   &kp END

             &none   &kp LC(CS_Z)   &kp LC(CS_X)   &kp LC(CS_C)   &kp LC(CS_V)   &kp LC(CS_Y)
             // TODO: the unused left pinkie
             &none   &kp UP      &kp DOWN    &kp LEFT    &kp RIGHT   &caps_word 

             &none   &kp LALT   &kp LCTRL       &kp LSHFT       &kp LWIN        &none          &none
             &none   &none      &kp LG(KP_N5)   &kp LG(KP_N6)   &kp LG(KP_N7)   &kp CAPSLOCK   &none

                                                   &none   &none           &none               &none
                                                   &none   &kp LS(ENTER)   &kp LS(BACKSPACE)   &kp LS(DELETE)   
            >;
        };

        // ##############################

        num_layer {
            display-name= "NUM";
            bindings = <
                     &kp CS_LT   &kp CS_N7   &kp CS_N8   &kp CS_N9   &kp CS_GT
                     &none    &none    &none    &none    &none

             &none   &kp CS_N0     &kp CS_N1      &kp CS_N2         &kp CS_N3      &kp CS_EXCL
             &none   &kp CS_PLUS   &kp CS_SLASH   &kp CS_ASTERISK   &kp CS_MINUS   &none
             
             &none   &kp LALT   &hml LCTRL N4   &kp CS_N5      &kp CS_N6      &none      &none
             &none   &none      &kp RWIN       &kp RSHFT   &kp RCTRL   &kp LALT   &none
                                                   // todo: use
                                                   &none   &kp CS_EQUAL   &kp CS_DOT  &none
                                                   &none   &none       &none    &none   
            >;
        };

        // ##############################

        sym_layer {
            display-name= "SYM";
            bindings = <                                           // todo: euro when shifted
                     &kp CS_PERCENT   &kp CS_CARET   &kp CS_HASH   &kp CS_DOLLAR   &kp CS_TILDE
                     &none         &none       &none      &none        &none

             &kp CS_BACKSLASH   &kp CS_Q       &kp CS_X           &kp CS_LEFT_BRACE   &kp CS_LEFT_BRACKET   &kp CS_PIPE
             &none           &kp CS_COLON   &kp CS_AMPERSAND   &kp CS_UNDERSCORE   &kp CS_SEMICOLON      &none
                     //todo: unicode - degree
             &none   &none   &kp CS_AT     &kp CS_RIGHT_BRACE   &kp CS_RIGHT_BRACKET   &none      &none
             &none   &none   &kp RWIN   &kp RSHFT         &kp RCTRL           &kp LALT   &none
                                                   
                                                   &kp CS_SINGLE_QUOTE   &kp CS_DOUBLE_QUOTES   &kp CS_GRAVE  &none
                                                   &none              &none               &none      &none    
            >;
        };

        // ##############################

        fun_layer {
            display-name= "FUN";
            bindings = <
                     &kp F10   &kp F7   &kp F8   &kp F9   &none
                     &none     &none    &none    &none    &bootloader

             &kp PRINTSCREEN   &kp F11   &kp F1   &kp F2   &kp F3   &kp K_SCROLL_DOWN
             &none   &kp CS_PLUS   &kp CS_SLASH   &kp CS_ASTERISK   &kp CS_MINUS   &none
             
             &none   &kp F12   &kp F4     &kp F5      &kp F6      &none      &none
             &none   &none     &kp RWIN   &kp RSHFT   &kp RCTRL   &kp LALT   &none
                                                   // todo: use all these
                                                   &none   &none   &none   &none
                                                   &none   &none   &none   &none    
            >;
        };

        // ##############################

        czech_layer {
            display-name= "CZECH";
            bindings = <
                     &none       &none        &none       &none       &bootloader
                     &cs_acu U   &cs_ring U   &cs_car D   &cs_car N   &cs_car T

             &none       &cs_acu A   &cs_car R   &cs_car S   &cs_car Z   &none
             &cs_car C   &cs_car E   &cs_acu E   &cs_acu I   &cs_acu Y   &cs_acu O

             &none   &kp LALT   &kp LCTRL       &kp LSHFT       &kp LWIN        &none          &none
             &none   &none      &none   &kp RSHFT   &none   &none   &none // todo: emoji

                                                   &none   &none           &none               &none
                                                   &none   &none   &none   &none  // todo: emoji   
            >;
        };

        // ##############################

        winmgr_layer {
            display-name= "WINMGR";
            bindings = <
                     &none   &kp LG(KP_N7)   &kp LG(KP_N8)   &kp LG(KP_N9)   &none
                     &none   &kp LG(L)       &kp LG(U)   &kp LG(Y)   &kp LG(B)

             &none       &kp LG(KP_N0)   &kp LG(KP_N1)   &kp LG(KP_N2)   &kp LG(KP_N3)   &none
             &kp LG(H)   &kp LG(N)       &kp LG(E)       &kp LG(I)       &kp LG(O)       &kp LG(K)
             
             &none   &kp LALT   &kp LG(KP_N4)   &hml LSHFT LG(KP_N5)   &kp LG(KP_N6)   &none   &none
             &none   &none     &kp LG(F21)   &kp RSHFT   &kp LG(F23)   &kp LG(F24)   &none
                                                   
                                                   &none   &none   &none         &none
                                                   // todo: 
                                                   &none   &none   &kp LG(F20)   &none    
            >;
        };
    };
};
